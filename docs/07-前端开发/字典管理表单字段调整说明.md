# 字典管理表单字段调整说明

## 修改日期
2026-01-01

## 修改原因
前端字典表单中包含了 `cssClass` 和 `listClass` 两个样式属性字段，但后端模型 `model.DictData` 和请求结构中并不支持这些字段，导致前后端不一致。

## 问题分析

### 后端模型结构
`internal/domain/model/s_dict.go` 中的 `DictData` 模型包含以下字段：
- ID
- ParentId
- Sort
- DictLabel
- DictValue
- DictType
- IsDefault
- Status
- Remark
- CreateBy/UpdateBy
- CreatedTime/UpdatedTime
- DeletedAt

**不包含** `cssClass` 和 `listClass` 字段。

### 后端请求结构
`internal/domain/request/dict.go` 中的请求结构也不包含样式相关字段：
- CreateDictRequest
- UpdateDictRequest

### 前端表单问题
`web/src/views/system/dict/DictModal.vue` 中原本包含：
```typescript
{
  field: 'cssClass',
  label: '样式属性',
  component: 'Input',
},
{
  field: 'listClass',
  label: '表格回显样式',
  component: 'Select',
  componentProps: {
    options: [
      { label: '默认', value: 'default' },
      { label: '主要', value: 'primary' },
      { label: '成功', value: 'success' },
      { label: '信息', value: 'info' },
      { label: '警告', value: 'warning' },
      { label: '危险', value: 'danger' },
    ],
  },
},
```

## 修改内容

### 1. 移除表单中的样式字段
从 `web/src/views/system/dict/DictModal.vue` 中移除了 `cssClass` 和 `listClass` 两个表单字段。

### 2. 修复 isDefault 字段类型
将 `isDefault` 字段从字符串类型（'Y'/'N'）改为布尔类型（true/false），与后端模型保持一致。

**表单组件修改：**
- 组件类型：从 `Select` 改为 `Switch`
- 默认值：从 `'N'` 改为 `false`
- 移除了选项配置

**表格显示修改：**
- 判断逻辑：从 `record.isDefault === 'Y'` 改为 `record.isDefault`

### 3. 修复类型导入
将类型导入从错误的路径：
```typescript
import type { FormSchema } from '@/types/components';
```

修改为正确的路径：
```typescript
import type { FormSchema } from '@/types/form';
```

### 4. 扩展表单类型定义
在 `web/src/types/form.d.ts` 中添加了 `Switch` 组件类型支持：
```typescript
component: 'Input' | 'Select' | 'DatePicker' | 'RangePicker' | 'InputNumber' | 'Textarea' | 'Switch';
```

## 修改后的表单字段

字典表单现在包含以下字段：
1. **dictType** - 字典类型（必填）
2. **dictLabel** - 字典标签（必填）
3. **dictValue** - 字典键值（必填）
4. **dictSort** - 字典排序（默认值：0）
5. **isDefault** - 是否默认（Switch 组件，默认值：false）
6. **status** - 状态（默认值：'0'）
7. **remark** - 备注

## 表格显示
`web/src/views/system/dict/index.vue` 中的表格列配置保持不变，本来就没有显示样式相关字段。

表格显示的列：
- 字典ID
- 字典类型
- 字典标签
- 字典键值
- 排序
- 默认
- 状态
- 创建时间
- 操作

## 影响范围
- ✅ 前端表单字段与后端模型保持一致
- ✅ 避免提交无效字段到后端
- ✅ 修复了类型导入错误
- ✅ 表格显示不受影响

## 注意事项
如果将来需要支持样式属性功能，需要：
1. 在后端 `DictData` 模型中添加相应字段
2. 在数据库表中添加相应列
3. 更新 `CreateDictRequest` 和 `UpdateDictRequest` 结构
4. 然后再在前端表单中添加这些字段

## 相关文件
- `web/src/views/system/dict/DictModal.vue` - 字典表单组件
- `web/src/views/system/dict/index.vue` - 字典列表页面
- `internal/domain/model/s_dict.go` - 字典数据模型
- `internal/domain/request/dict.go` - 字典请求结构
- `web/src/types/form.d.ts` - 表单类型定义
